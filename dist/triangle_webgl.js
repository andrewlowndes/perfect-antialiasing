(self.webpackChunksubpixel_rendering=self.webpackChunksubpixel_rendering||[]).push([[323],{558:function(e,r,n){"use strict";var t=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(o,i){function a(e){try{c(t.next(e))}catch(e){i(e)}}function s(e){try{c(t.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?o(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}c((t=t.apply(e,r||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const i=n(887),a=n(886),s=o(n(822)),c=o(n(934));let l,p,v,x,f,P,d;const u=()=>{l.clear(l.COLOR_BUFFER_BIT),i.mat4.rotateY(v,v,.04/Math.PI),i.mat4.multiply(f,p,v),i.mat4.multiply(P,x,f),l.uniformMatrix4fv(d,!1,P),l.drawArrays(l.TRIANGLES,0,3),requestAnimationFrame(u)};t(void 0,void 0,void 0,(function*(){(()=>{const e=document.getElementById("canvas1");l=e.getContext("webgl2",{antialias:!1,premultipliedAlpha:!1});const r=Math.sqrt(2)/e.width,n=new Float32Array([1,-1,0,0,1,0,-1,-1,0]),t=new Float32Array([0,1,0,-1,-1,0,1,-1,0]),o=new Float32Array([-1,-1,0,1,-1,0,0,1,0]),u=new Float32Array([1,0,0,0,1,0,0,0,1]),m=new Float32Array([0,1,2]),A=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,A),l.bufferData(l.ARRAY_BUFFER,n,l.STATIC_DRAW);const h=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,h),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW);const g=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,g),l.bufferData(l.ARRAY_BUFFER,o,l.STATIC_DRAW);const b=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,b),l.bufferData(l.ARRAY_BUFFER,m,l.STATIC_DRAW);const y=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,y),l.bufferData(l.ARRAY_BUFFER,u,l.STATIC_DRAW);const R=a.loadShader(l,s.default,c.default);l.useProgram(R);const F=l.getAttribLocation(R,"pos");l.bindBuffer(l.ARRAY_BUFFER,A),l.vertexAttribPointer(F,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(F);const M=l.getAttribLocation(R,"colour");l.bindBuffer(l.ARRAY_BUFFER,y),l.vertexAttribPointer(M,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(M);const _=l.getAttribLocation(R,"prevPos");l.bindBuffer(l.ARRAY_BUFFER,g),l.vertexAttribPointer(_,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(_);const S=l.getAttribLocation(R,"nextPos");l.bindBuffer(l.ARRAY_BUFFER,h),l.vertexAttribPointer(S,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(S);const T=l.getUniformLocation(R,"offset");l.uniform1f(T,r);const w=l.getUniformLocation(R,"screenSize");l.uniform2fv(w,[e.width,e.height]),v=i.mat4.create(),p=i.mat4.create(),i.mat4.lookAt(p,[0,0,-5],[0,0,0],[0,1,0]),x=i.mat4.create(),i.mat4.perspective(x,.25*Math.PI,e.width/e.height,1,100),f=i.mat4.create(),P=i.mat4.create(),i.mat4.multiply(f,p,v),i.mat4.multiply(P,x,f),d=l.getUniformLocation(R,"modelViewProjection"),l.uniformMatrix4fv(d,!1,P),l.clearColor(0,0,0,0),l.viewport(0,0,e.width,e.height),l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE)})(),u()}))},886:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loadShader=void 0,r.loadShader=(e,r,n)=>{const t=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(t,r),e.compileShader(t),""!==String(e.getShaderInfoLog(t)).trim())throw new Error(String(e.getShaderInfoLog(t)));const o=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(o,n),e.compileShader(o),""!==String(e.getShaderInfoLog(o)).trim())throw new Error(String(e.getShaderInfoLog(o)));const i=e.createProgram();if(e.attachShader(i,t),e.attachShader(i,o),e.linkProgram(i),""!==String(e.getProgramInfoLog(i)).trim())throw new Error(String(e.getProgramInfoLog(i)));return i}},934:e=>{"use strict";e.exports="#version 300 es\r\n\r\nprecision highp float;\r\n\r\nin vec3 vColour;\r\n\r\nflat in vec4 bounds;\r\nflat in vec2 vPrevPos;\r\nflat in vec2 vPos;\r\nflat in vec2 vNextPos;\r\nflat in vec2 e1;\r\nflat in vec2 e2;\r\nflat in vec2 e3;\r\n\r\nconst float delta = 0.000001;\r\n\r\nout vec4 outColor;\r\n\r\nvec4 sort(vec4 val) {\r\n  float a = min(val.x, val.y);\r\n  float b = max(val.x, val.y);\r\n  float c = min(val.z, val.w);\r\n  float d = max(val.z, val.w);\r\n\r\n  float e = min(b, c);\r\n  float f = max(b, c);\r\n  float h = max(a, e);\r\n  float i = min(f, d);\r\n\r\n  return vec4(min(a, e), min(h, i), max(h, i), max(f, d));\r\n}\r\n\r\nfloat det2(vec2 p1, vec2 p2) {\r\n  return (p1.x * p2.y) - (p1.y * p2.x);\r\n}\r\n\r\nfloat timeAtPos(float startPos, float dir, float newPos) {\r\n  if (abs(dir) < delta) {\r\n      return 0.0;\r\n  }\r\n\r\n  return clamp((newPos - startPos) / dir, 0.0, 1.0);\r\n}\r\n\r\nvoid main(void) {\r\n  //remove conservative rasterisation overdraw\r\n  if (gl_FragCoord.x < bounds.x || gl_FragCoord.y < bounds.y || gl_FragCoord.x > bounds.z || gl_FragCoord.y > bounds.w) {\r\n      discard;\r\n  }\r\n\r\n  //intersect the triangle with the pixel bounds\r\n  vec2 pixelMin = floor(gl_FragCoord.xy);\r\n  vec2 pixelMax = ceil(gl_FragCoord.xy);\r\n\r\n  vec4 firstLineTs = sort(vec4(\r\n      timeAtPos(vPrevPos.x, e1.x, pixelMin.x),\r\n      timeAtPos(vPrevPos.x, e1.x, pixelMax.x),\r\n      timeAtPos(vPrevPos.y, e1.y, pixelMin.y),\r\n      timeAtPos(vPrevPos.y, e1.y, pixelMax.y)\r\n  ));\r\n\r\n  vec2 p1 = clamp(vPrevPos + e1 * firstLineTs.x, pixelMin, pixelMax);\r\n  vec2 p2 = clamp(vPrevPos + e1 * firstLineTs.y, pixelMin, pixelMax);\r\n  vec2 p3 = clamp(vPrevPos + e1 * firstLineTs.z, pixelMin, pixelMax);\r\n  vec2 p4 = clamp(vPrevPos + e1 * firstLineTs.w, pixelMin, pixelMax);\r\n\r\n  vec4 secondLineTs = sort(vec4(\r\n      timeAtPos(vPos.x, e2.x, pixelMin.x),\r\n      timeAtPos(vPos.x, e2.x, pixelMax.x),\r\n      timeAtPos(vPos.y, e2.y, pixelMin.y),\r\n      timeAtPos(vPos.y, e2.y, pixelMax.y)\r\n  ));\r\n\r\n  vec2 p5 = clamp(vPos + e2 * secondLineTs.x, pixelMin, pixelMax);\r\n  vec2 p6 = clamp(vPos + e2 * secondLineTs.y, pixelMin, pixelMax);\r\n  vec2 p7 = clamp(vPos + e2 * secondLineTs.z, pixelMin, pixelMax);\r\n  vec2 p8 = clamp(vPos + e2 * secondLineTs.w, pixelMin, pixelMax);\r\n  \r\n  vec4 thirdLineTs = sort(vec4(\r\n      timeAtPos(vNextPos.x, e3.x, pixelMin.x),\r\n      timeAtPos(vNextPos.x, e3.x, pixelMax.x),\r\n      timeAtPos(vNextPos.y, e3.y, pixelMin.y),\r\n      timeAtPos(vNextPos.y, e3.y, pixelMax.y)\r\n  ));\r\n\r\n  vec2 p9  = clamp(vNextPos + e3 * thirdLineTs.x, pixelMin, pixelMax);\r\n  vec2 p10 = clamp(vNextPos + e3 * thirdLineTs.y, pixelMin, pixelMax);\r\n  vec2 p11 = clamp(vNextPos + e3 * thirdLineTs.z, pixelMin, pixelMax);\r\n  vec2 p12 = clamp(vNextPos + e3 * thirdLineTs.w, pixelMin, pixelMax);\r\n\r\n  //compute the area under the formed polygon\r\n  float polygonArea = (\r\n      det2(p1, p2) + det2(p2, p3) + det2(p3, p4) + det2(p4, p5) +\r\n      det2(p5, p6) + det2(p6, p7) + det2(p7, p8) + det2(p8, p9) + \r\n      det2(p9, p10) + det2(p10, p11) + det2(p11, p12) + det2(p12, p1)\r\n  ) / 2.0;\r\n\r\n  float alphaAmount = clamp(abs(polygonArea), 0.0, 1.0);\r\n  \r\n  outColor = vec4(vColour, alphaAmount);\r\n}\r\n"},822:e=>{"use strict";e.exports="#version 300 es\r\n\r\nuniform vec2 screenSize;\r\nuniform float offset;\r\nuniform mat4 modelViewProjection;\r\n\r\nin vec3 pos;\r\nin vec3 colour;\r\nin vec3 prevPos;\r\nin vec3 nextPos;\r\n\r\nout vec3 vColour;\r\n\r\nflat out vec4 bounds;\r\nflat out vec2 vPrevPos;\r\nflat out vec2 vPos;\r\nflat out vec2 vNextPos;\r\nflat out vec2 e1;\r\nflat out vec2 e2;\r\nflat out vec2 e3;\r\n\r\nconst float delta = 0.0000001;\r\n\r\nvec2 posToClipSpace(vec3 pos) {\r\n    vec4 proj_pos = modelViewProjection * vec4(pos, 1.0);\r\n    return proj_pos.xy / proj_pos.w;\r\n}\r\n\r\nvec2 clipToScreenSpace(vec2 pos) {\r\n    return screenSize.xy * (pos / 2.0 + 0.5);\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 clipPos = posToClipSpace(pos);\r\n    vec2 clipNextPos = posToClipSpace(nextPos);\r\n    vec2 clipPrevPos = posToClipSpace(prevPos);\r\n\r\n    // determine a new vertex position such that it covers the neighbour pixel centers\r\n    vec2 a = normalize(clipPos - clipPrevPos);\r\n    vec2 b = normalize(clipPos - clipNextPos);\r\n    float angle = sqrt((1.0 - dot(a, b)) / 2.0);\r\n\r\n    vec2 vecPos;\r\n    if (abs(angle) > delta) {\r\n        vecPos = clipPos + normalize(a + b) * (offset / angle);\r\n    } else {\r\n        vecPos = clipPos;\r\n    }\r\n\r\n    // compute a bounding box and pass to the fragment shader so we dont render outside the inflated triangle bounds\r\n    vec2 screenPos = clipToScreenSpace(clipPos);\r\n    vec2 screenNextPos = clipToScreenSpace(clipNextPos);\r\n    vec2 screenPrevPos = clipToScreenSpace(clipPrevPos);\r\n    \r\n    bounds = vec4(\r\n        min(min(screenPos, screenNextPos), screenPrevPos) - 0.5,\r\n        max(max(screenPos, screenNextPos), screenPrevPos) + 0.5\r\n    );\r\n\r\n    //translate the position into screen space\r\n    vPrevPos = screenPrevPos;\r\n    vPos = screenPos;\r\n    vNextPos = screenNextPos;\r\n    e1 = vPos - vPrevPos;\r\n    e2 = vNextPos - vPos;\r\n    e3 = vPrevPos - vNextPos;\r\n    \r\n    vColour = colour;\r\n    gl_Position = vec4(vecPos, 0.0, 1.0);\r\n}\r\n"}},e=>{"use strict";e(e.s=558)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdWJwaXhlbC1yZW5kZXJpbmcvLi9zcmMvZGVtb3MvdHJpYW5nbGVXZWJnbC50cyIsIndlYnBhY2s6Ly9zdWJwaXhlbC1yZW5kZXJpbmcvLi9zcmMvdXRpbHMvbG9hZFNoYWRlci50cyJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIl9faW1wb3J0RGVmYXVsdCIsIm1vZCIsIl9fZXNNb2R1bGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJnbF9tYXRyaXhfMSIsImxvYWRTaGFkZXJfMSIsInRyaWFuZ2xlX3ZlcnRfMSIsInRyaWFuZ2xlX2ZyYWdfMSIsImdsIiwidmlld01hdHJpeCIsIm1vZGVsTWF0cml4IiwicHJvamVjdGlvbk1hdHJpeCIsIm1vZGVsVmlld01hdHJpeCIsIm1vZGVsVmlld1Byb2plY3Rpb25NYXRyaXgiLCJtb2RlbFZpZXdQcm9qZWN0aW9uVW5pZm9ybSIsImRyYXciLCJjbGVhciIsIkNPTE9SX0JVRkZFUl9CSVQiLCJtYXQ0Iiwicm90YXRlWSIsIk1hdGgiLCJQSSIsIm11bHRpcGx5IiwidW5pZm9ybU1hdHJpeDRmdiIsImRyYXdBcnJheXMiLCJUUklBTkdMRVMiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsImFudGlhbGlhcyIsInByZW11bHRpcGxpZWRBbHBoYSIsIm9mZnNldCIsInNxcnQiLCJ3aWR0aCIsInZlcnRpY2VzIiwiRmxvYXQzMkFycmF5IiwibmV4dFBvcyIsInByZXZQb3MiLCJjb2xvdXIiLCJpbmRleGVzIiwicG9zQnVmZmVyIiwiY3JlYXRlQnVmZmVyIiwiYmluZEJ1ZmZlciIsIkFSUkFZX0JVRkZFUiIsImJ1ZmZlckRhdGEiLCJTVEFUSUNfRFJBVyIsIm5leHRQb3NCdWZmZXIiLCJwcmV2UG9zQnVmZmVyIiwiaW5kZXhCdWZmZXIiLCJjb2xvdXJCdWZmZXIiLCJzaGFkZXJQcm9ncmFtIiwibG9hZFNoYWRlciIsImRlZmF1bHQiLCJ1c2VQcm9ncmFtIiwicG9zQXR0ciIsImdldEF0dHJpYkxvY2F0aW9uIiwidmVydGV4QXR0cmliUG9pbnRlciIsIkZMT0FUIiwiZW5hYmxlVmVydGV4QXR0cmliQXJyYXkiLCJjb2xvdXJBdHRyIiwicHJldlBvc0F0dHIiLCJuZXh0UG9zQXR0ciIsIm9mZnNldFVuaWZvcm0iLCJnZXRVbmlmb3JtTG9jYXRpb24iLCJ1bmlmb3JtMWYiLCJzY3JlZW5TaXplVW5pZm9ybSIsInVuaWZvcm0yZnYiLCJoZWlnaHQiLCJjcmVhdGUiLCJsb29rQXQiLCJwZXJzcGVjdGl2ZSIsImNsZWFyQ29sb3IiLCJ2aWV3cG9ydCIsImVuYWJsZSIsIkJMRU5EIiwiYmxlbmRGdW5jIiwiT05FIiwibG9hZCIsInZlcnRDb2RlIiwiZnJhZ0NvZGUiLCJ2ZXJ0U2hhZGVyIiwiY3JlYXRlU2hhZGVyIiwiVkVSVEVYX1NIQURFUiIsInNoYWRlclNvdXJjZSIsImNvbXBpbGVTaGFkZXIiLCJTdHJpbmciLCJnZXRTaGFkZXJJbmZvTG9nIiwidHJpbSIsIkVycm9yIiwiZnJhZ1NoYWRlciIsIkZSQUdNRU5UX1NIQURFUiIsImNyZWF0ZVByb2dyYW0iLCJhdHRhY2hTaGFkZXIiLCJsaW5rUHJvZ3JhbSIsImdldFByb2dyYW1JbmZvTG9nIl0sIm1hcHBpbmdzIjoiNEhBQ0EsSUFBSUEsRUFBYUMsTUFBUUEsS0FBS0QsV0FBYyxTQUFVRSxFQUFTQyxFQUFZQyxFQUFHQyxHQUUxRSxPQUFPLElBQUtELElBQU1BLEVBQUlFLFdBQVUsU0FBVUMsRUFBU0MsR0FDL0MsU0FBU0MsRUFBVUMsR0FBUyxJQUFNQyxFQUFLTixFQUFV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Qk4sS0FFL0MsTUFBTVMsRUFBYW5GLEVBQUcyRSxhQUFhM0UsRUFBR29GLGlCQUd0QyxHQUZBcEYsRUFBRzZFLGFBQWFNLEVBQVlWLEdBQzVCekUsRUFBRzhFLGNBQWNLLEdBQ3NDLEtBQW5ESixPQUFPL0UsRUFBR2dGLGlCQUFpQkcsSUFBYUYsT0FDeEMsTUFBTSxJQUFJQyxNQUFNSCxPQUFPL0UsRUFBR2dGLGlCQUFpQkcsS0FFL0MsTUFBTXZDLEVBQWdCNUMsRUFBR3FGLGdCQUl6QixHQUhBckYsRUFBR3NGLGFBQWExQyxFQUFlOEIsR0FDL0IxRSxFQUFHc0YsYUFBYTFDLEVBQWV1QyxHQUMvQm5GLEVBQUd1RixZQUFZM0MsR0FDNEMsS0FBdkRtQyxPQUFPL0UsRUFBR3dGLGtCQUFrQjVDLElBQWdCcUMsT0FDNUMsTUFBTSxJQUFJQyxNQUFNSCxPQUFPL0UsRUFBR3dGLGtCQUFrQjVDLEtBRWhELE9BQU9BLEkiLCJmaWxlIjoidHJpYW5nbGVfd2ViZ2wuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGdsX21hdHJpeF8xID0gcmVxdWlyZShcImdsLW1hdHJpeFwiKTtcclxuY29uc3QgbG9hZFNoYWRlcl8xID0gcmVxdWlyZShcIi4uL3V0aWxzL2xvYWRTaGFkZXJcIik7XHJcbmNvbnN0IHRyaWFuZ2xlX3ZlcnRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vc2hhZGVycy90cmlhbmdsZS52ZXJ0XCIpKTtcclxuY29uc3QgdHJpYW5nbGVfZnJhZ18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9zaGFkZXJzL3RyaWFuZ2xlLmZyYWdcIikpO1xyXG5sZXQgZ2w7XHJcbmxldCB2aWV3TWF0cml4O1xyXG5sZXQgbW9kZWxNYXRyaXg7XHJcbmxldCBwcm9qZWN0aW9uTWF0cml4O1xyXG5sZXQgbW9kZWxWaWV3TWF0cml4O1xyXG5sZXQgbW9kZWxWaWV3UHJvamVjdGlvbk1hdHJpeDtcclxubGV0IG1vZGVsVmlld1Byb2plY3Rpb25Vbmlmb3JtO1xyXG5jb25zdCBsb2FkID0gKCkgPT4ge1xyXG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhczEnKTtcclxuICAgIGdsID0gY2FudmFzLmdldENvbnRleHQoJ3dlYmdsMicsIHsgYW50aWFsaWFzOiBmYWxzZSwgcHJlbXVsdGlwbGllZEFscGhhOiBmYWxzZSB9KTtcclxuICAgIGNvbnN0IG9mZnNldCA9IE1hdGguc3FydCgyKSAvIGNhbnZhcy53aWR0aDtcclxuICAgIGNvbnN0IHZlcnRpY2VzID0gbmV3IEZsb2F0MzJBcnJheShbXHJcbiAgICAgICAgMSwgLTEsIDAsXHJcbiAgICAgICAgMCwgMSwgMCxcclxuICAgICAgICAtMSwgLTEsIDBcclxuICAgIF0pO1xyXG4gICAgY29uc3QgbmV4dFBvcyA9IG5ldyBGbG9hdDMyQXJyYXkoW1xyXG4gICAgICAgIDAsIDEsIDAsXHJcbiAgICAgICAgLTEsIC0xLCAwLFxyXG4gICAgICAgIDEsIC0xLCAwXHJcbiAgICBdKTtcclxuICAgIGNvbnN0IHByZXZQb3MgPSBuZXcgRmxvYXQzMkFycmF5KFtcclxuICAgICAgICAtMSwgLTEsIDAsXHJcbiAgICAgICAgMSwgLTEsIDAsXHJcbiAgICAgICAgMCwgMSwgMFxyXG4gICAgXSk7XHJcbiAgICBjb25zdCBjb2xvdXIgPSBuZXcgRmxvYXQzMkFycmF5KFtcclxuICAgICAgICAxLCAwLCAwLFxyXG4gICAgICAgIDAsIDEsIDAsXHJcbiAgICAgICAgMCwgMCwgMVxyXG4gICAgXSk7XHJcbiAgICBjb25zdCBpbmRleGVzID0gbmV3IEZsb2F0MzJBcnJheShbMCwgMSwgMl0pO1xyXG4gICAgLy8gQ3JlYXRlIGFuIGVtcHR5IGJ1ZmZlciBvYmplY3QgdG8gc3RvcmUgdmVydGV4IGJ1ZmZlclxyXG4gICAgY29uc3QgcG9zQnVmZmVyID0gZ2wuY3JlYXRlQnVmZmVyKCk7XHJcbiAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgcG9zQnVmZmVyKTtcclxuICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCB2ZXJ0aWNlcywgZ2wuU1RBVElDX0RSQVcpO1xyXG4gICAgY29uc3QgbmV4dFBvc0J1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIG5leHRQb3NCdWZmZXIpO1xyXG4gICAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIG5leHRQb3MsIGdsLlNUQVRJQ19EUkFXKTtcclxuICAgIGNvbnN0IHByZXZQb3NCdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBwcmV2UG9zQnVmZmVyKTtcclxuICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBwcmV2UG9zLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgICBjb25zdCBpbmRleEJ1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIGluZGV4QnVmZmVyKTtcclxuICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBpbmRleGVzLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgICBjb25zdCBjb2xvdXJCdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBjb2xvdXJCdWZmZXIpO1xyXG4gICAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIGNvbG91ciwgZ2wuU1RBVElDX0RSQVcpO1xyXG4gICAgY29uc3Qgc2hhZGVyUHJvZ3JhbSA9IGxvYWRTaGFkZXJfMS5sb2FkU2hhZGVyKGdsLCB0cmlhbmdsZV92ZXJ0XzEuZGVmYXVsdCwgdHJpYW5nbGVfZnJhZ18xLmRlZmF1bHQpO1xyXG4gICAgZ2wudXNlUHJvZ3JhbShzaGFkZXJQcm9ncmFtKTtcclxuICAgIGNvbnN0IHBvc0F0dHIgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihzaGFkZXJQcm9ncmFtLCBcInBvc1wiKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBwb3NCdWZmZXIpO1xyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihwb3NBdHRyLCAzLCBnbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xyXG4gICAgZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkocG9zQXR0cik7XHJcbiAgICBjb25zdCBjb2xvdXJBdHRyID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgXCJjb2xvdXJcIik7XHJcbiAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgY29sb3VyQnVmZmVyKTtcclxuICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIoY29sb3VyQXR0ciwgMywgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcclxuICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGNvbG91ckF0dHIpO1xyXG4gICAgLy8gbmVlZCB0byBkdXBsaWNhdGUgdGhlIHZlcnRleCBidWZmZXJzIGp1c3QgdG8gYWNjZXNzIHRoZSBvdGhlciB0cmlhbmdsZSBwb3NpdGlvbnMgOihcclxuICAgIGNvbnN0IHByZXZQb3NBdHRyID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgXCJwcmV2UG9zXCIpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHByZXZQb3NCdWZmZXIpO1xyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihwcmV2UG9zQXR0ciwgMywgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcclxuICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHByZXZQb3NBdHRyKTtcclxuICAgIGNvbnN0IG5leHRQb3NBdHRyID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgXCJuZXh0UG9zXCIpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIG5leHRQb3NCdWZmZXIpO1xyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihuZXh0UG9zQXR0ciwgMywgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcclxuICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KG5leHRQb3NBdHRyKTtcclxuICAgIGNvbnN0IG9mZnNldFVuaWZvcm0gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgJ29mZnNldCcpO1xyXG4gICAgZ2wudW5pZm9ybTFmKG9mZnNldFVuaWZvcm0sIG9mZnNldCk7XHJcbiAgICBjb25zdCBzY3JlZW5TaXplVW5pZm9ybSA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihzaGFkZXJQcm9ncmFtLCAnc2NyZWVuU2l6ZScpO1xyXG4gICAgZ2wudW5pZm9ybTJmdihzY3JlZW5TaXplVW5pZm9ybSwgW2NhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodF0pO1xyXG4gICAgbW9kZWxNYXRyaXggPSBnbF9tYXRyaXhfMS5tYXQ0LmNyZWF0ZSgpO1xyXG4gICAgdmlld01hdHJpeCA9IGdsX21hdHJpeF8xLm1hdDQuY3JlYXRlKCk7XHJcbiAgICBnbF9tYXRyaXhfMS5tYXQ0Lmxvb2tBdCh2aWV3TWF0cml4LCBbMCwgMCwgLTVdLCBbMCwgMCwgMF0sIFswLCAxLCAwXSk7XHJcbiAgICBwcm9qZWN0aW9uTWF0cml4ID0gZ2xfbWF0cml4XzEubWF0NC5jcmVhdGUoKTtcclxuICAgIGdsX21hdHJpeF8xLm1hdDQucGVyc3BlY3RpdmUocHJvamVjdGlvbk1hdHJpeCwgNDUuMCAvIDE4MCAqIE1hdGguUEksIGNhbnZhcy53aWR0aCAvIGNhbnZhcy5oZWlnaHQsIDEsIDEwMCk7XHJcbiAgICBtb2RlbFZpZXdNYXRyaXggPSBnbF9tYXRyaXhfMS5tYXQ0LmNyZWF0ZSgpO1xyXG4gICAgbW9kZWxWaWV3UHJvamVjdGlvbk1hdHJpeCA9IGdsX21hdHJpeF8xLm1hdDQuY3JlYXRlKCk7XHJcbiAgICBnbF9tYXRyaXhfMS5tYXQ0Lm11bHRpcGx5KG1vZGVsVmlld01hdHJpeCwgdmlld01hdHJpeCwgbW9kZWxNYXRyaXgpO1xyXG4gICAgZ2xfbWF0cml4XzEubWF0NC5tdWx0aXBseShtb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4LCBwcm9qZWN0aW9uTWF0cml4LCBtb2RlbFZpZXdNYXRyaXgpO1xyXG4gICAgbW9kZWxWaWV3UHJvamVjdGlvblVuaWZvcm0gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgXCJtb2RlbFZpZXdQcm9qZWN0aW9uXCIpO1xyXG4gICAgZ2wudW5pZm9ybU1hdHJpeDRmdihtb2RlbFZpZXdQcm9qZWN0aW9uVW5pZm9ybSwgZmFsc2UsIG1vZGVsVmlld1Byb2plY3Rpb25NYXRyaXgpO1xyXG4gICAgZ2wuY2xlYXJDb2xvcigwLjAsIDAuMCwgMC4wLCAwLjApO1xyXG4gICAgZ2wudmlld3BvcnQoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgIGdsLmVuYWJsZShnbC5CTEVORCk7XHJcbiAgICBnbC5ibGVuZEZ1bmMoZ2wuT05FLCBnbC5PTkUpO1xyXG59O1xyXG5jb25zdCBkcmF3ID0gKCkgPT4ge1xyXG4gICAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCk7XHJcbiAgICBnbF9tYXRyaXhfMS5tYXQ0LnJvdGF0ZVkobW9kZWxNYXRyaXgsIG1vZGVsTWF0cml4LCAwLjA0IC8gTWF0aC5QSSk7XHJcbiAgICBnbF9tYXRyaXhfMS5tYXQ0Lm11bHRpcGx5KG1vZGVsVmlld01hdHJpeCwgdmlld01hdHJpeCwgbW9kZWxNYXRyaXgpO1xyXG4gICAgZ2xfbWF0cml4XzEubWF0NC5tdWx0aXBseShtb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4LCBwcm9qZWN0aW9uTWF0cml4LCBtb2RlbFZpZXdNYXRyaXgpO1xyXG4gICAgZ2wudW5pZm9ybU1hdHJpeDRmdihtb2RlbFZpZXdQcm9qZWN0aW9uVW5pZm9ybSwgZmFsc2UsIG1vZGVsVmlld1Byb2plY3Rpb25NYXRyaXgpO1xyXG4gICAgZ2wuZHJhd0FycmF5cyhnbC5UUklBTkdMRVMsIDAsIDMpO1xyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpO1xyXG59O1xyXG5jb25zdCBzdGFydCA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgbG9hZCgpO1xyXG4gICAgZHJhdygpO1xyXG59KTtcclxuc3RhcnQoKTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5sb2FkU2hhZGVyID0gdm9pZCAwO1xyXG5jb25zdCBsb2FkU2hhZGVyID0gKGdsLCB2ZXJ0Q29kZSwgZnJhZ0NvZGUpID0+IHtcclxuICAgIGNvbnN0IHZlcnRTaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIoZ2wuVkVSVEVYX1NIQURFUik7XHJcbiAgICBnbC5zaGFkZXJTb3VyY2UodmVydFNoYWRlciwgdmVydENvZGUpO1xyXG4gICAgZ2wuY29tcGlsZVNoYWRlcih2ZXJ0U2hhZGVyKTtcclxuICAgIGlmIChTdHJpbmcoZ2wuZ2V0U2hhZGVySW5mb0xvZyh2ZXJ0U2hhZGVyKSkudHJpbSgpICE9PSAnJykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihTdHJpbmcoZ2wuZ2V0U2hhZGVySW5mb0xvZyh2ZXJ0U2hhZGVyKSkpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZnJhZ1NoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihnbC5GUkFHTUVOVF9TSEFERVIpO1xyXG4gICAgZ2wuc2hhZGVyU291cmNlKGZyYWdTaGFkZXIsIGZyYWdDb2RlKTtcclxuICAgIGdsLmNvbXBpbGVTaGFkZXIoZnJhZ1NoYWRlcik7XHJcbiAgICBpZiAoU3RyaW5nKGdsLmdldFNoYWRlckluZm9Mb2coZnJhZ1NoYWRlcikpLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoU3RyaW5nKGdsLmdldFNoYWRlckluZm9Mb2coZnJhZ1NoYWRlcikpKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHNoYWRlclByb2dyYW0gPSBnbC5jcmVhdGVQcm9ncmFtKCk7XHJcbiAgICBnbC5hdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgdmVydFNoYWRlcik7XHJcbiAgICBnbC5hdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgZnJhZ1NoYWRlcik7XHJcbiAgICBnbC5saW5rUHJvZ3JhbShzaGFkZXJQcm9ncmFtKTtcclxuICAgIGlmIChTdHJpbmcoZ2wuZ2V0UHJvZ3JhbUluZm9Mb2coc2hhZGVyUHJvZ3JhbSkpLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoU3RyaW5nKGdsLmdldFByb2dyYW1JbmZvTG9nKHNoYWRlclByb2dyYW0pKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2hhZGVyUHJvZ3JhbTtcclxufTtcclxuZXhwb3J0cy5sb2FkU2hhZGVyID0gbG9hZFNoYWRlcjtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==